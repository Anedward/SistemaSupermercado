<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<h:head>
</h:head>
<body style="background-image: url('resources/assets/img/10.jpg'">

	<h:form id="formFacturas" styleClass="formularios">
		<p:panel id="panelFac" styleClass="panel">
			<p:layoutUnit id="datosFactura" styleClass="datosFactura"
				position="east">
				<p:panel>
				<h:panelGrid columns="3">

					<h:outputLabel value="N° Factura: " />
					<h:inputText value="#{facturaDetalleController.factura.numFact}"
						id="txtNumFactura" />
					<h:message for="txtNumFactura" />

					<h:outputLabel value="Fecha: " />
					<h:outputText
						value="#{facturaDetalleController.factura.fechaEmision}"
						id="txttFecha" />
					<h:message for="txtFecha" />

					
				</h:panelGrid>
			</p:panel>

			</p:layoutUnit>


		</p:panel>
		<p:panel id="panel" styleClass="panel">

			<p:panel style="margin-top: 20px; height: 80px;">
				<f:facet name="header">
					<h:outputText value="Productos"
						style="margin-left: 0px; margin-right: -12px;" />
				</f:facet>
				<p:panelGrid id="prodPanel" styleClass="prodPanel" columns="4"
					columnClasses="column1,columna2p,columna3p,columna4p"
					style="font-size: 14px !important; margin-left: -15px; margin-top: -4px;">
					<p:outputLabel value="Código de barrra:"
						style="margin-left: -12px;" />
					<p:inputText value="#{facturaDetalleController.codBarra}" size="25" />
					<p:commandButton value="Buscar" icon="fa fa fa-search"
						styleClass="btn-success"
						actionListener="#{facturaDetalleController.agregarDatosProductoCod()}"
						update=":formFacturas:tablaProductos :formFacturas:TotalVenta" />
						
					<p:commandButton value="&#x1F50E; en Carrito" icon="fa fa fa-edit"
						styleClass="OcularBotones btn-success"
						oncomplete="PF('dialogoProducto').show();" />
				</p:panelGrid>
			</p:panel>

			

			<p:panel style=" margin-top: 2px; height: 205px;">
				<p:dataTable id="tablaProductos" var="producto"
					value="#{facturaDetalleController.listaDetalles}"
					rowStyleClass="ejemplo, ejemplo2"
					emptyMessage="No se han encontrado registros." paginator="true"
					paginatorPosition="top" rows="4">

					<p:column headerText="Código de barra">

						<h:outputText value="#{producto.producto.codBarra}" />
					</p:column>
					<p:column headerText="Producto">
						<h:outputText value="#{producto.producto.nombre}" />
					</p:column>
					<p:column headerText="Cantidad">
						<h:outputText value="#{producto.cantidad}" />
					</p:column>
					<p:column headerText="Precio venta">
						<h:outputText value="$ #{producto.producto.precioVenta}" />
					</p:column>

					<p:column headerText="Precio Total">
						<h:outputText
							value="#{producto.cantidad * producto.producto.precioVenta}" />
					</p:column>
				</p:dataTable>
			</p:panel>
			
			<p:outputLabel>Subtotal: </p:outputLabel>
			<p:outputLabel id="TotalVenta" value="#{facturaDetalleController.sum()}" style="margin-top: 3px;" />
			<p:separator style="margin-top: 5px;" />
			
			<p:outputLabel>IVA: </p:outputLabel>
			<p:outputLabel value="0.12" style="margin-top: 3px;" />
			<p:separator style="margin-top: 5px;" />
			
			<p:outputLabel>Total: </p:outputLabel>
			<p:outputLabel id="txtTotal" value="#{facturaDetalleController.totalFac()}" style="margin-top: 3px;" />
			<p:separator style="margin-top: 5px;" />
			
			<!--  
			<h:outputLabel value="Iva" />
					<h:outputText value="0.12"
						id="txtIva" />
					<h:message for="txtIva" />

					<h:outputLabel value="Total" />
					<h:outputText value="#{facturaDetalleController.totalFac()}"
						id="txtTotal" />
					<h:message for="txtTotal" />
			-->
			<p:separator style="margin-top: 5px;" />
			<p:commandButton value="Guardar" styleClass="btn btn-info"
				style="margin-top: 2px;"
				actionListener="#{facturaDetalleController.guardarVenta()}"
				update=":formFacturas" />
			
			<p:commandButton value="Cancelar" styleClass="btn btn-danger"
				style="margin-top: 2px;"
				action="#{facturaDetalleController.limpiarFactura()}"
				update=":formFacturas" />
		</p:panel>


		<p:dialog id="dlgProducto" widgetVar="dialogoProducto" modal="true"
			showEffect="explode" hideEffect="explode"
			styleClass="dialogoClientes" resizable="false" position="center"
			responsive="true" draggable="false" closeOnEscape="true"
			closable="false">


			<p:dataTable id="tablaProdAUX" paginator="true"
				paginatorPosition="top" style="width: 700px;" var="pro"
				value="#{productoController.listaProductos}" rows="5">
				
					<f:facet name="header">
					<h:outputText value="Producto" />
					</f:facet>
						
				<p:column headerText="Codigo">
				<h:outputText value="#{pro.codigo}" />
				</p:column>
					
					<p:column headerText="Nombre">
				<h:outputText value="#{pro.nombre}" />
				</p:column>
				
				<p:column headerText="Precio">
				<h:outputText value="#{pro.precioVenta}" />
				</p:column>
				
				
				<p:column headerText="Agregar">
					<p:commandButton value="+ &#128722;" icon="fa fa fa-cart-plus"
						styleClass="btn-success"
						action="#{facturaDetalleController.orderBy(pro)}"
						onclick="PF('dialogoProducto').hide();"
						update=":formFacturas:tablaProductos :formFacturas:txtTotal :formFacturas:TotalVenta :formFacturas:txtNumFactura">

					</p:commandButton>
				</p:column>
			</p:dataTable>
			<center>
				<p:separator />
				<p:commandButton value="cerrar" icon="fa fa fa-mail-reply"
					styleClass="btn-danger" style="margin-top: 8px;"
					onclick="PF('dialogoProducto').hide();" />
			</center>
		</p:dialog>

		<p:dialog id="dlgCantidadProducto" widgetVar="dialogoCantidadProducto"
			header="Cantidad" modal="true">
			Cantidad de Productos a Vender: 
			<p:inputText id="txtCantidadProducto" value="#{facturaDetalleController.cantidadProducto}" />

			<p:commandButton value="Aceptar"
				actionListener="#{facturaDetalleController.agregarDatosProductoCod()}"
				update="formFacturas:tablaProductos :formFacturas:dlgCantidadProducto"
				oncomplete="PF('dlgCantidadProducto').hide();PF(dialogoProducto').hide();" />
		</p:dialog>
	</h:form>
</body>
</html>
